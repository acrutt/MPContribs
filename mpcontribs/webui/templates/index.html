<!DOCTYPE html>
<html lang="en">
  <head>
    <title>MPFile Viewer</title>
    <script src="{{ url_for('static', filename='js/react-0.11.0.js') }}"></script>
    <script src="{{ url_for('static', filename='js/JSXTransformer-0.11.0.js') }}"></script>
    <script src="{{ url_for('static', filename='js/jsonViewer.min.js') }}"></script>
    <link href="{{ url_for('static', filename='css/screen.css') }}" media="screen, projection" rel="stylesheet" type="text/css" />
    <script type="text/javascript" charset="utf8" src="{{ url_for('static', filename='js/jquery.js') }}"></script>
    <script type="text/javascript" charset="utf8" src="{{ url_for('static', filename='js/jquery.dataTables.js') }}"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"/>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.css" />
    <script src="https://cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.js"></script>
    <link rel="icon" href="data:;base64,=">
  </head>
  <body>
    <p><a name="top"></a>
    <p><a class="btn btn-primary" role="button" href="/">Load New MPFile</a></p>
    <div class="btn-toolbar" role="toolbar">
    {% for value in content.itervalues() %}
    {% for project_data in value.itervalues() %}
    {% for cid in project_data %}
    <a href="#cid{{ cid }}" class="btn btn-default btn-group" role="group" role="button">#{{ cid }}</a>
    {% endfor %}
    {% endfor %}
    {% endfor %}
    </div>
    {% for key,value in content.iteritems() %}
    {% for project,project_data in value.iteritems() %}
    {% for cid,cid_data in project_data.iteritems() %}
    <a name="cid{{ cid }}"></a><h1>{{ key }} &raquo; {{ project }} &raquo; #{{ cid }}</h1>
    <div class="btn-toolbar" role="toolbar">
      <a href="#top" class="btn btn-default btn-group" role="group" role="button">back to top</a>
      <a href="#{{ cid }}_jump_tree" class="btn btn-default btn-group" role="group" role="button">Hierarchical Data</a>
      <a href="#{{ cid }}_jump_tables" class="btn btn-default btn-group" role="group" role="button">Tables</a>
      <a href="#{{ cid }}_jump_graphs" class="btn btn-default btn-group" role="group" role="button">Graphs</a>
    </div>
    {% for data_type,data in cid_data.iteritems() %}
    {% if data_type == "tree_data" %}
    <a name="{{ cid }}_jump_tree"></a><h2>Hierarchical Data</h2>
    <a href="#top" class="btn btn-default btn-xs" role="button">back to top</a>
    <div id="{{ cid }}_tree"></div>
    <script type="text/jsx">
    /** @jsx React.DOM */
    var lol = {{ data|tojson|safe }};
    React.renderComponent(
      <JSONTree data={lol} />, document.getElementById('{{ cid }}_tree')
    );
    </script>
    {% elif data_type == "tables" %}
    <a name="{{ cid }}_jump_tables"></a><h2>Tables</h2>
    <a href="#top" class="btn btn-default btn-xs" role="button">back to top</a>
    {% for table_name,table_data in data.iteritems() %}
    <p>
      <b>{{ table_name }}</b>
      <button class="btn btn-primary btn-xs" type="button" data-toggle="collapse"
              data-target="#{{ cid }}_{{ loop.index }}_collapse" aria-expanded="false"
              aria-controls="{{ cid }}_{{ loop.index }}_collapse">
        Collapse/Expand
      </button>
      <div class="collapse" id="{{ cid }}_{{ loop.index }}_collapse">
        <table id="{{ cid }}_{{ loop.index }}_table" class="table"></table>
        <script>
        var table = {{ table_data|tojson|safe }};
        $('#{{ cid }}_{{ loop.index }}_table').DataTable({
          "data": table['rows'], "columns": table['columns'], "scrollX": true,
          "scrollY": "300px", "scrollCollapse": true, "paging": false
        });
        </script>
      </div>
    </p>
    {% endfor %}
    {% elif data_type == "plotly_urls" %}
    <a name="{{ cid }}_jump_graphs"></a><h2>Graphs</h2>
    <div><a href="#top" class="btn btn-default btn-xs" role="button">back to top</a></div>
    {% for url in data %}
    <iframe width="580" height="580" frameborder="0" seamless="seamless"
       scrolling="no" src="{{url}}.embed?width=580&height=580"></iframe>
    {% endfor %}
    {% endif %}
    {% endfor %}
    {% endfor %}
    {% endfor %}
    {% endfor %}
  </body>
</html>
